# Database Design

## Overview
The Workout Tracker application uses a MySQL relational database with three main tables. The database schema is automatically generated by Hibernate/JPA from the entity classes using the `spring.jpa.hibernate.ddl-auto=update` configuration.

---

## Database Tables

### 1. `exercises` Table
Stores the exercise library - all available exercises that can be added to workouts.

**Table Name:** `exercises`

| Column Name      | Data Type | Constraints           | Description                          |
|------------------|-----------|-----------------------|--------------------------------------|
| `exercise_id`    | BIGINT    | PRIMARY KEY, AUTO_INCREMENT | Unique identifier for each exercise  |
| `name`           | VARCHAR   | NOT NULL              | Exercise name (e.g., "Bench Press")  |
| `muscle_group`   | VARCHAR   | NULL                  | Muscle group (e.g., "Chest", "Legs") |

**Primary Key:** `exercise_id`

**Example Data:**
```
exercise_id | name         | muscle_group
------------|--------------|-------------
1           | Bench Press  | Chest
2           | Squats       | Legs
3           | Deadlift     | Back
```

---

### 2. `workouts` Table
Stores workout sessions - each workout represents a training session on a specific date.

**Table Name:** `workouts`

| Column Name      | Data Type | Constraints           | Description                          |
|------------------|-----------|-----------------------|--------------------------------------|
| `workout_id`     | BIGINT    | PRIMARY KEY, AUTO_INCREMENT | Unique identifier for each workout  |
| `workout_date`   | DATE      | NOT NULL              | Date of the workout session          |
| `notes`          | TEXT      | NULL                  | Optional notes about the workout     |

**Primary Key:** `workout_id`

**Example Data:**
```
workout_id | workout_date | notes
-----------|--------------|------------------
1          | 2024-01-15   | Great session!
2          | 2024-01-17   | NULL
```

---

### 3. `workout_entries` Table
Junction/join table that connects workouts to exercises. Stores the specific details of each exercise performed in a workout (sets, reps, weight).

**Table Name:** `workout_entries`

| Column Name      | Data Type | Constraints           | Description                          |
|------------------|-----------|-----------------------|--------------------------------------|
| `entry_id`       | BIGINT    | PRIMARY KEY, AUTO_INCREMENT | Unique identifier for each entry    |
| `workout_id`     | BIGINT    | NOT NULL, FOREIGN KEY | References workouts.workout_id      |
| `exercise_id`    | BIGINT    | NOT NULL, FOREIGN KEY | References exercises.exercise_id    |
| `sets`           | INT       | NOT NULL              | Number of sets performed             |
| `reps`           | INT       | NOT NULL              | Number of repetitions per set        |
| `weight`         | DOUBLE    | NOT NULL              | Weight in kilograms                  |

**Primary Key:** `entry_id`

**Foreign Keys:**
1. `workout_id` → `workouts.workout_id`
   - Relationship: Many workout_entries belong to one workout
   - Cascade: When a workout is deleted, all its entries are automatically deleted (CASCADE DELETE)
   - Orphan Removal: When an entry is removed from a workout's entries list, it is deleted from the database

2. `exercise_id` → `exercises.exercise_id`
   - Relationship: Many workout_entries can reference the same exercise
   - Purpose: Multiple workouts can use the same exercise

**Example Data:**
```
entry_id | workout_id | exercise_id | sets | reps | weight
---------|------------|--------------|------|------|-------
1        | 1          | 1            | 3    | 10   | 80.0
2        | 1          | 2            | 4    | 12   | 100.0
3        | 2          | 1            | 3    | 8    | 85.0
```

---

## Relationships

### One-to-Many: Workout → WorkoutEntry
- **Relationship:** One workout can have many workout entries
- **Implementation:** `workouts.workout_id` (one) ← `workout_entries.workout_id` (many)
- **Cascade Behavior:** CASCADE ALL - Operations on workout cascade to entries
- **Orphan Removal:** Enabled - Removing an entry from workout's list deletes it from database

### Many-to-One: WorkoutEntry → Exercise
- **Relationship:** Many workout entries can reference the same exercise
- **Implementation:** `workout_entries.exercise_id` (many) → `exercises.exercise_id` (one)
- **Purpose:** Allows multiple workouts to track the same exercise

### Many-to-One: WorkoutEntry → Workout
- **Relationship:** Many workout entries belong to one workout
- **Implementation:** `workout_entries.workout_id` (many) → `workouts.workout_id` (one)

---

## Database Constraints Summary

### Primary Keys
- `exercises.exercise_id`
- `workouts.workout_id`
- `workout_entries.entry_id`

### Foreign Keys
- `workout_entries.workout_id` → `workouts.workout_id`
- `workout_entries.exercise_id` → `exercises.exercise_id`

### NOT NULL Constraints
- `exercises.name`
- `workouts.workout_date`
- `workout_entries.workout_id`
- `workout_entries.exercise_id`
- `workout_entries.sets`
- `workout_entries.reps`
- `workout_entries.weight`

### Auto-Increment
- All primary keys use AUTO_INCREMENT for automatic ID generation

---

## Database Generation

The database schema is automatically created and maintained by Hibernate ORM based on the JPA entity annotations. When the application starts:

1. Hibernate reads the entity classes (`@Entity` annotations)
2. Generates the corresponding database tables
3. Creates primary keys, foreign keys, and constraints
4. Updates the schema if entity changes are detected (due to `ddl-auto=update`)

**No manual SQL scripts are required** - the entire database structure is managed through ORM annotations.

---

## Example Queries (for reference - application uses ORM only)

### Get all exercises
```sql
SELECT * FROM exercises;
```

### Get all workouts with their entries
```sql
SELECT w.workout_id, w.workout_date, e.name, we.sets, we.reps, we.weight
FROM workouts w
LEFT JOIN workout_entries we ON w.workout_id = we.workout_id
LEFT JOIN exercises e ON we.exercise_id = e.exercise_id;
```

### Get workouts between dates (used in reports)
```sql
SELECT * FROM workouts 
WHERE workout_date BETWEEN '2024-01-01' AND '2024-01-31';
```

**Note:** The application uses Spring Data JPA repositories instead of writing SQL queries. The above queries are shown for reference only.

